2025-03-27 13:15:43,574 - af_claseq - INFO - Pipeline initialized with config from configs/config_run.yaml
2025-03-27 13:15:43,577 - af_claseq - INFO - === AF-ClaSeq PIPELINE STARTED ===
2025-03-27 13:15:43,577 - af_claseq - INFO - Configuration loaded from YAML file
2025-03-27 13:15:43,577 - af_claseq - INFO - === STAGE 02_RUN: M-FOLD SAMPLING ===
2025-03-27 13:15:43,577 - af_claseq - INFO - Running M-fold sampling for 1 rounds
2025-03-27 13:15:43,577 - af_claseq - INFO - Starting M-fold sampling round 1/1
2025-03-27 13:15:43,579 - af_claseq - INFO - Applying coverage filter with threshold 0.8
2025-03-27 13:15:43,585 - af_claseq - INFO - Filtered sequences from 753 to 605
2025-03-27 13:15:43,595 - af_claseq - INFO - Performing initial random split
2025-03-27 13:15:43,730 - af_claseq - INFO - Created 10 initial groups
2025-03-27 13:15:43,730 - af_claseq - INFO - Creating sampling splits
2025-03-27 13:15:44,605 - af_claseq - INFO - Created 9 sampling splits
2025-03-27 13:15:44,605 - af_claseq - INFO - Submitting 10 SLURM jobs
2025-03-27 13:15:44,605 - af_claseq.slurm_utils - INFO - Processing 10 folders concurrently
2025-03-27 13:15:44,606 - af_claseq.slurm_utils - INFO - Processing folder: run/02_m_fold_sampling/round_1/02_sampling/sampling_10
2025-03-27 13:15:44,606 - af_claseq.slurm_utils - INFO - Processing folder: run/02_m_fold_sampling/round_1/02_sampling/sampling_9
2025-03-27 13:15:44,607 - af_claseq.slurm_utils - INFO - Processing folder: run/02_m_fold_sampling/round_1/02_sampling/sampling_6
2025-03-27 13:15:44,607 - af_claseq.slurm_utils - INFO - Processing folder: run/02_m_fold_sampling/round_1/02_sampling/sampling_1
2025-03-27 13:15:44,607 - af_claseq.slurm_utils - INFO - Processing folder: run/02_m_fold_sampling/round_1/02_sampling/sampling_5
2025-03-27 13:15:44,608 - af_claseq.slurm_utils - INFO - Processing folder: run/02_m_fold_sampling/round_1/02_sampling/sampling_8
2025-03-27 13:15:44,608 - af_claseq.slurm_utils - INFO - Submitting job for run/02_m_fold_sampling/round_1/02_sampling/sampling_10 (Job ID: sample_1)
2025-03-27 13:15:44,608 - af_claseq.slurm_utils - INFO - Processing folder: run/02_m_fold_sampling/round_1/02_sampling/sampling_7
2025-03-27 13:15:44,609 - af_claseq.slurm_utils - INFO - Processing folder: run/02_m_fold_sampling/round_1/02_sampling/sampling_2
2025-03-27 13:15:44,609 - af_claseq.slurm_utils - INFO - Submitting job for run/02_m_fold_sampling/round_1/02_sampling/sampling_9 (Job ID: sample_2)
2025-03-27 13:15:44,609 - af_claseq.slurm_utils - INFO - Processing folder: run/02_m_fold_sampling/round_1/02_sampling/sampling_4
2025-03-27 13:15:44,615 - af_claseq.slurm_utils - INFO - Submitting job for run/02_m_fold_sampling/round_1/02_sampling/sampling_6 (Job ID: sample_3)
2025-03-27 13:15:44,616 - af_claseq.slurm_utils - INFO - Processing folder: run/02_m_fold_sampling/round_1/02_sampling/sampling_3
2025-03-27 13:15:44,616 - af_claseq.slurm_utils - INFO - Submitting job for run/02_m_fold_sampling/round_1/02_sampling/sampling_1 (Job ID: sample_4)
2025-03-27 13:15:44,618 - af_claseq.slurm_utils - INFO - Submitting job for run/02_m_fold_sampling/round_1/02_sampling/sampling_5 (Job ID: sample_5)
2025-03-27 13:15:44,618 - af_claseq.slurm_utils - INFO - Submitting job for run/02_m_fold_sampling/round_1/02_sampling/sampling_7 (Job ID: sample_7)
2025-03-27 13:15:44,620 - af_claseq.slurm_utils - INFO - Submitting job for run/02_m_fold_sampling/round_1/02_sampling/sampling_8 (Job ID: sample_6)
2025-03-27 13:15:44,623 - af_claseq.slurm_utils - INFO - Submitting job for run/02_m_fold_sampling/round_1/02_sampling/sampling_2 (Job ID: sample_8)
2025-03-27 13:15:44,628 - af_claseq.slurm_utils - INFO - Submitting job for run/02_m_fold_sampling/round_1/02_sampling/sampling_3 (Job ID: sample_10)
2025-03-27 13:15:44,630 - af_claseq.slurm_utils - INFO - Submitting job for run/02_m_fold_sampling/round_1/02_sampling/sampling_4 (Job ID: sample_9)
2025-03-27 13:15:44,711 - af_claseq.slurm_utils - INFO - Submitted job 501012 for task directory run/02_m_fold_sampling/round_1/02_sampling/sampling_9
2025-03-27 13:15:44,712 - af_claseq.slurm_utils - INFO - Waiting for job 501012 to complete
2025-03-27 13:15:44,715 - af_claseq.slurm_utils - INFO - Submitted job 501013 for task directory run/02_m_fold_sampling/round_1/02_sampling/sampling_10
2025-03-27 13:15:44,715 - af_claseq.slurm_utils - INFO - Waiting for job 501013 to complete
2025-03-27 13:15:44,721 - af_claseq.slurm_utils - INFO - Submitted job 501014 for task directory run/02_m_fold_sampling/round_1/02_sampling/sampling_3
2025-03-27 13:15:44,721 - af_claseq.slurm_utils - INFO - Waiting for job 501014 to complete
2025-03-27 13:15:44,723 - af_claseq.slurm_utils - INFO - Submitted job 501015 for task directory run/02_m_fold_sampling/round_1/02_sampling/sampling_8
2025-03-27 13:15:44,723 - af_claseq.slurm_utils - INFO - Waiting for job 501015 to complete
2025-03-27 13:15:44,726 - af_claseq.slurm_utils - INFO - Submitted job 501016 for task directory run/02_m_fold_sampling/round_1/02_sampling/sampling_1
2025-03-27 13:15:44,726 - af_claseq.slurm_utils - INFO - Waiting for job 501016 to complete
2025-03-27 13:15:44,729 - af_claseq.slurm_utils - INFO - Submitted job 501017 for task directory run/02_m_fold_sampling/round_1/02_sampling/sampling_7
2025-03-27 13:15:44,729 - af_claseq.slurm_utils - INFO - Waiting for job 501017 to complete
2025-03-27 13:15:44,732 - af_claseq.slurm_utils - INFO - Submitted job 501018 for task directory run/02_m_fold_sampling/round_1/02_sampling/sampling_2
2025-03-27 13:15:44,732 - af_claseq.slurm_utils - INFO - Waiting for job 501018 to complete
2025-03-27 13:15:44,734 - af_claseq.slurm_utils - INFO - Submitted job 501019 for task directory run/02_m_fold_sampling/round_1/02_sampling/sampling_5
2025-03-27 13:15:44,734 - af_claseq.slurm_utils - INFO - Waiting for job 501019 to complete
2025-03-27 13:15:44,737 - af_claseq.slurm_utils - INFO - Submitted job 501020 for task directory run/02_m_fold_sampling/round_1/02_sampling/sampling_4
2025-03-27 13:15:44,737 - af_claseq.slurm_utils - INFO - Waiting for job 501020 to complete
2025-03-27 13:15:44,740 - af_claseq.slurm_utils - INFO - Submitted job 501021 for task directory run/02_m_fold_sampling/round_1/02_sampling/sampling_6
2025-03-27 13:15:44,740 - af_claseq.slurm_utils - INFO - Waiting for job 501021 to complete
2025-03-27 13:18:45,047 - af_claseq.slurm_utils - INFO - Job 501015 completed
2025-03-27 13:18:45,049 - af_claseq.slurm_utils - INFO - Job 501021 completed
2025-03-27 13:18:45,051 - af_claseq.slurm_utils - INFO - Job 501016 completed
2025-03-27 13:18:45,064 - af_claseq.slurm_utils - INFO - All PDB files generated for run/02_m_fold_sampling/round_1/02_sampling/sampling_6
2025-03-27 13:18:45,071 - af_claseq.slurm_utils - INFO - All PDB files generated for run/02_m_fold_sampling/round_1/02_sampling/sampling_1
2025-03-27 13:18:45,073 - af_claseq.slurm_utils - INFO - All PDB files generated for run/02_m_fold_sampling/round_1/02_sampling/sampling_8
2025-03-27 13:18:45,088 - af_claseq.slurm_utils - INFO - Job 501020 completed
2025-03-27 13:18:45,091 - af_claseq.slurm_utils - INFO - Job 501019 completed
2025-03-27 13:18:45,092 - af_claseq.slurm_utils - INFO - Job 501013 completed
2025-03-27 13:18:45,094 - af_claseq.slurm_utils - INFO - Job 501012 completed
2025-03-27 13:18:45,096 - af_claseq.slurm_utils - INFO - All PDB files generated for run/02_m_fold_sampling/round_1/02_sampling/sampling_9
2025-03-27 13:18:45,101 - af_claseq.slurm_utils - INFO - All PDB files generated for run/02_m_fold_sampling/round_1/02_sampling/sampling_10
2025-03-27 13:18:45,102 - af_claseq.slurm_utils - INFO - Job 501014 completed
2025-03-27 13:18:45,104 - af_claseq.slurm_utils - INFO - All PDB files generated for run/02_m_fold_sampling/round_1/02_sampling/sampling_5
2025-03-27 13:18:45,107 - af_claseq.slurm_utils - INFO - Job 501017 completed
2025-03-27 13:18:45,110 - af_claseq.slurm_utils - INFO - Job 501018 completed
2025-03-27 13:18:45,124 - af_claseq.slurm_utils - INFO - All PDB files generated for run/02_m_fold_sampling/round_1/02_sampling/sampling_4
2025-03-27 13:18:45,126 - af_claseq.slurm_utils - INFO - All PDB files generated for run/02_m_fold_sampling/round_1/02_sampling/sampling_3
2025-03-27 13:18:45,126 - af_claseq.slurm_utils - INFO - All PDB files generated for run/02_m_fold_sampling/round_1/02_sampling/sampling_2
2025-03-27 13:18:45,128 - af_claseq.slurm_utils - INFO - All PDB files generated for run/02_m_fold_sampling/round_1/02_sampling/sampling_7
2025-03-27 13:18:45,128 - af_claseq - INFO - Submitted all SLURM jobs
2025-03-27 13:18:45,128 - af_claseq - INFO - Completed all 1 rounds of M-fold sampling successfully
2025-03-27 13:18:45,128 - af_claseq - INFO - === STAGE 02_ANALYSIS: M-FOLD SAMPLING ANALYSIS ===
2025-03-27 13:18:45,131 - af_claseq - INFO - Analyzing data from 1 rounds of M-fold sampling
2025-03-27 13:18:45,131 - af_claseq - INFO - Including round 1 in analysis
2025-03-27 13:18:45,131 - af_claseq - INFO - Two filter criteria detected - generating 1D plots for each criterion and 2D plots
2025-03-27 13:18:45,131 - af_claseq - INFO - Generating 1D plot for 2qke_tmscore
2025-03-27 13:18:45,131 - af_claseq - INFO - Calculating metrics for 2qke_tmscore
2025-03-27 13:18:45,131 - af_claseq - INFO - Processing results from 1 directories
2025-03-27 13:18:45,132 - af_claseq - INFO - Processing directory 1/1: run/02_m_fold_sampling/round_1
2025-03-27 13:18:45,132 - af_claseq.af_claseq.utils.structure_analysis - INFO - Processing run/02_m_fold_sampling/round_1
2025-03-27 13:18:45,135 - af_claseq.af_claseq.utils.structure_analysis - INFO - Found 90 PDB files
2025-03-27 13:18:50,755 - af_claseq - ERROR - Error in M-fold sampling analysis: 'PDB'
Traceback (most recent call last):
  File "/fs/ess/PAA0203/xing244/.conda/envs/colabfold/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'PDB'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/fs/ess/PAA0203/xing244/AF_ClaSeq/examples/KaiB/../../run_af_claseq_pipeline.py", line 361, in plot_m_fold_sampling
    plot_m_fold_sampling_1d(
  File "/fs/ess/PAA0203/xing244/AF_ClaSeq/src/af_claseq/utils/plotting_manager.py", line 614, in plot_m_fold_sampling_1d
    results_df = load_results_df(
  File "/fs/ess/PAA0203/xing244/AF_ClaSeq/src/af_claseq/utils/plotting_manager.py", line 101, in load_results_df
    dir_results = calculate_metric_values(
  File "/fs/ess/PAA0203/xing244/AF_ClaSeq/src/af_claseq/utils/plotting_manager.py", line 188, in calculate_metric_values
    'PDB': results_df['PDB'],
  File "/fs/ess/PAA0203/xing244/.conda/envs/colabfold/lib/python3.10/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/fs/ess/PAA0203/xing244/.conda/envs/colabfold/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'PDB'
2025-03-27 13:18:50,820 - af_claseq - ERROR - Stopping pipeline due to failure in stage 02_PLOT
2025-03-27 13:20:01,504 - af_claseq - INFO - Pipeline initialized with config from configs/config_run.yaml
2025-03-27 13:20:01,506 - af_claseq - INFO - === AF-ClaSeq PIPELINE STARTED ===
2025-03-27 13:20:01,506 - af_claseq - INFO - Configuration loaded from YAML file
2025-03-27 13:20:01,506 - af_claseq - INFO - === STAGE 02_ANALYSIS: M-FOLD SAMPLING ANALYSIS ===
2025-03-27 13:20:01,507 - af_claseq - INFO - Analyzing data from 1 rounds of M-fold sampling
2025-03-27 13:20:01,507 - af_claseq - INFO - Including round 1 in analysis
2025-03-27 13:20:01,507 - af_claseq - INFO - Two filter criteria detected - generating 1D plots for each criterion and 2D plots
2025-03-27 13:20:01,507 - af_claseq - INFO - Generating 1D plot for 2qke_tmscore
2025-03-27 13:20:01,508 - af_claseq - INFO - Calculating metrics for 2qke_tmscore
2025-03-27 13:20:01,508 - af_claseq - INFO - Processing results from 1 directories
2025-03-27 13:20:01,508 - af_claseq - INFO - Processing directory 1/1: run/02_m_fold_sampling/round_1
2025-03-27 13:20:01,508 - af_claseq.af_claseq.utils.structure_analysis - INFO - Processing run/02_m_fold_sampling/round_1
2025-03-27 13:20:01,517 - af_claseq.af_claseq.utils.structure_analysis - INFO - Found 90 PDB files
2025-03-27 13:20:04,839 - af_claseq - INFO - Combined 90 results from all directories
2025-03-27 13:20:04,915 - af_claseq - INFO - Saved results to run/02_m_fold_sampling/csv/2qke_tmscore_values.csv
2025-03-27 13:20:04,915 - af_claseq - INFO - Generating 1D distribution plot for 2qke_tmscore
2025-03-27 13:20:07,873 - af_claseq - INFO - Saved 1D distribution plot to: run/02_m_fold_sampling/plot/2qke_tmscore_1d_distribution.png
2025-03-27 13:20:07,873 - af_claseq - INFO - Mean 2qke_tmscore: 0.69
2025-03-27 13:20:07,874 - af_claseq - INFO - Median 2qke_tmscore: 0.69
2025-03-27 13:20:07,874 - af_claseq - INFO - Generating 1D plot for 5jyt_tmscore
2025-03-27 13:20:07,874 - af_claseq - INFO - Calculating metrics for 5jyt_tmscore
2025-03-27 13:20:07,875 - af_claseq - INFO - Processing results from 1 directories
2025-03-27 13:20:07,875 - af_claseq - INFO - Processing directory 1/1: run/02_m_fold_sampling/round_1
2025-03-27 13:20:07,875 - af_claseq.af_claseq.utils.structure_analysis - INFO - Processing run/02_m_fold_sampling/round_1
2025-03-27 13:20:07,880 - af_claseq.af_claseq.utils.structure_analysis - INFO - Found 90 PDB files
2025-03-27 13:20:07,980 - af_claseq - INFO - Combined 90 results from all directories
2025-03-27 13:20:07,982 - af_claseq - INFO - Saved results to run/02_m_fold_sampling/csv/5jyt_tmscore_values.csv
2025-03-27 13:20:07,982 - af_claseq - INFO - Generating 1D distribution plot for 5jyt_tmscore
2025-03-27 13:20:10,627 - af_claseq - INFO - Saved 1D distribution plot to: run/02_m_fold_sampling/plot/5jyt_tmscore_1d_distribution.png
2025-03-27 13:20:10,628 - af_claseq - INFO - Mean 5jyt_tmscore: 0.61
2025-03-27 13:20:10,628 - af_claseq - INFO - Median 5jyt_tmscore: 0.56
2025-03-27 13:20:10,628 - af_claseq - INFO - Generating 2D plot for combined criteria: 2qke_tmscore vs 5jyt_tmscore
2025-03-27 13:20:10,628 - af_claseq - INFO - Calculating metrics for 2qke_tmscore, 5jyt_tmscore
2025-03-27 13:20:10,628 - af_claseq - INFO - Processing results from 1 directories
2025-03-27 13:20:10,628 - af_claseq - INFO - Processing directory 1/1: run/02_m_fold_sampling/round_1
2025-03-27 13:20:10,628 - af_claseq.af_claseq.utils.structure_analysis - INFO - Processing run/02_m_fold_sampling/round_1
2025-03-27 13:20:10,634 - af_claseq.af_claseq.utils.structure_analysis - INFO - Found 90 PDB files
2025-03-27 13:20:10,862 - af_claseq - INFO - Combined 90 results from all directories
2025-03-27 13:20:10,863 - af_claseq - INFO - Saved results to run/02_m_fold_sampling/csv/2qke_tmscore_5jyt_tmscore_values.csv
2025-03-27 13:20:11,604 - af_claseq - INFO - Saved 2D scatter plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_scatter_plddt.png
2025-03-27 13:20:12,358 - af_claseq - INFO - Saved 2D scatter plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_scatter_local_plddt.png
2025-03-27 13:20:13,975 - af_claseq - INFO - Saved joint plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_joint_plddt.png
2025-03-27 13:20:15,751 - af_claseq - INFO - Saved joint plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_joint_local_plddt.png
2025-03-27 13:20:15,751 - af_claseq - INFO - Completed M-fold sampling analysis and plotting successfully
2025-03-27 13:20:15,751 - af_claseq - INFO - === STAGE 03: SEQUENCE VOTING ===
2025-03-27 13:20:15,751 - af_claseq - INFO - Processing filter criterion: 2qke_tmscore
2025-03-27 13:20:15,752 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Starting sequence voting analysis for criterion: 2qke_tmscore
2025-03-27 13:20:15,753 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Processing sampling directories...
2025-03-27 13:20:15,755 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Looking for precomputed metrics in directory: run/02_m_fold_sampling/csv
2025-03-27 13:20:15,755 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Found 3 CSV files
2025-03-27 13:20:15,771 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Loaded metrics for 90 structures from precomputed files
2025-03-27 13:20:15,772 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Creating metric bins...
2025-03-27 13:20:15,772 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Processing sequence votes...
2025-03-27 13:20:15,793 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Found 1 sampling rounds
2025-03-27 13:20:15,801 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Collected 90 A3M/PDB file pairs
2025-03-27 13:20:15,801 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Processing 90 A3M files
2025-03-27 13:20:15,801 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - batch_size: 1
2025-03-27 13:20:17,264 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Raw sequence votes saved to run/03_voting/2qke_tmscore/raw_sequence_votes.json
2025-03-27 13:20:17,267 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Processed 120 sequences for criterion: 2qke_tmscore
2025-03-27 13:20:17,267 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Saved voting results to run/03_voting/2qke_tmscore/voting_results.csv
2025-03-27 13:20:18,431 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Created distribution plot: run/03_voting/2qke_tmscore/sequence_voting_distribution.png
2025-03-27 13:20:18,431 - af_claseq - INFO - Processing filter criterion: 5jyt_tmscore
2025-03-27 13:20:18,432 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Starting sequence voting analysis for criterion: 5jyt_tmscore
2025-03-27 13:20:18,432 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Processing sampling directories...
2025-03-27 13:20:18,432 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Looking for precomputed metrics in directory: run/02_m_fold_sampling/csv
2025-03-27 13:20:18,432 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Found 3 CSV files
2025-03-27 13:20:18,448 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Loaded metrics for 90 structures from precomputed files
2025-03-27 13:20:18,449 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Creating metric bins...
2025-03-27 13:20:18,449 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Processing sequence votes...
2025-03-27 13:20:18,450 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Found 1 sampling rounds
2025-03-27 13:20:18,459 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Collected 90 A3M/PDB file pairs
2025-03-27 13:20:18,459 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Processing 90 A3M files
2025-03-27 13:20:18,459 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - batch_size: 1
2025-03-27 13:20:19,927 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Raw sequence votes saved to run/03_voting/5jyt_tmscore/raw_sequence_votes.json
2025-03-27 13:20:19,930 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Processed 120 sequences for criterion: 5jyt_tmscore
2025-03-27 13:20:19,930 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Saved voting results to run/03_voting/5jyt_tmscore/voting_results.csv
2025-03-27 13:20:20,950 - af_claseq.af_claseq.pipeline.sequence_voting - INFO - Created distribution plot: run/03_voting/5jyt_tmscore/sequence_voting_distribution.png
2025-03-27 13:20:20,950 - af_claseq - INFO - Completed sequence voting successfully for 2 criteria
2025-03-27 13:20:20,950 - af_claseq - INFO - === STAGE 04: SEQUENCE RECOMPILATION & PREDICTION ===
2025-03-27 13:20:20,951 - af_claseq - INFO - Processing recompilation and prediction for criterion: 2qke_tmscore
2025-03-27 13:20:20,954 - af_claseq - INFO - Loaded raw votes data from run/03_voting/2qke_tmscore/raw_sequence_votes.json
2025-03-27 13:20:20,954 - af_claseq - INFO - Processing bin 23
2025-03-27 13:20:20,954 - af_claseq - INFO - Extracting headers for bin 23
2025-03-27 13:20:20,957 - af_claseq - INFO - Found 7 sequences in specified bins
2025-03-27 13:20:20,957 - af_claseq - INFO - Creating vote distribution plot for bin 23
2025-03-27 13:20:22,070 - af_claseq - INFO - Created vote distribution plot for bin 23
2025-03-27 13:20:22,071 - af_claseq - INFO - Compiling sequences for prediction
2025-03-27 13:20:22,106 - af_claseq - INFO - Compiled 7 sequences to run/04_recompile/2qke_tmscore/prediction/bin_23/bin23_sequences.a3m
2025-03-27 13:20:22,106 - af_claseq - INFO - Creating control prediction file
2025-03-27 13:20:22,112 - af_claseq - INFO - Created control file with 7 random sequences
2025-03-27 13:20:22,112 - af_claseq - INFO - Completed processing bin 23
2025-03-27 13:20:22,112 - af_claseq - INFO - Processing bin 26
2025-03-27 13:20:22,112 - af_claseq - INFO - Extracting headers for bin 26
2025-03-27 13:20:22,115 - af_claseq - INFO - Found 5 sequences in specified bins
2025-03-27 13:20:22,115 - af_claseq - INFO - Creating vote distribution plot for bin 26
2025-03-27 13:20:22,812 - af_claseq - INFO - Created vote distribution plot for bin 26
2025-03-27 13:20:22,812 - af_claseq - INFO - Compiling sequences for prediction
2025-03-27 13:20:22,818 - af_claseq - INFO - Compiled 5 sequences to run/04_recompile/2qke_tmscore/prediction/bin_26/bin26_sequences.a3m
2025-03-27 13:20:22,818 - af_claseq - INFO - Creating control prediction file
2025-03-27 13:20:22,824 - af_claseq - INFO - Created control file with 5 random sequences
2025-03-27 13:20:22,825 - af_claseq - INFO - Completed processing bin 26
2025-03-27 13:20:22,825 - af_claseq - INFO - Completed recompilation for all bins
2025-03-27 13:20:22,825 - af_claseq - INFO - Starting prediction process...
2025-03-27 13:20:22,825 - af_claseq - INFO - Collecting jobs from prediction directory: run/04_recompile/2qke_tmscore/prediction
2025-03-27 13:20:22,825 - af_claseq - INFO - Added prediction job for bin 23: run/04_recompile/2qke_tmscore/prediction/bin_23
2025-03-27 13:20:22,825 - af_claseq - INFO - Added prediction job for bin 26: run/04_recompile/2qke_tmscore/prediction/bin_26
2025-03-27 13:20:22,825 - af_claseq - INFO - Collecting jobs from control_prediction directory: run/04_recompile/2qke_tmscore/control_prediction
2025-03-27 13:20:22,825 - af_claseq - INFO - Added control_prediction job for bin 23: run/04_recompile/2qke_tmscore/control_prediction/bin_23
2025-03-27 13:20:22,825 - af_claseq - INFO - Added control_prediction job for bin 26: run/04_recompile/2qke_tmscore/control_prediction/bin_26
2025-03-27 13:20:22,825 - af_claseq - INFO - Processing 4 jobs concurrently...
2025-03-27 13:20:22,825 - af_claseq.slurm_utils - INFO - Processing 4 folders concurrently
2025-03-27 13:20:22,825 - af_claseq.slurm_utils - INFO - Processing folder: run/04_recompile/2qke_tmscore/prediction/bin_23 (prediction)
2025-03-27 13:20:22,826 - af_claseq.slurm_utils - INFO - Processing folder: run/04_recompile/2qke_tmscore/prediction/bin_26 (prediction)
2025-03-27 13:20:22,826 - af_claseq.slurm_utils - INFO - Processing folder: run/04_recompile/2qke_tmscore/control_prediction/bin_23 (control_prediction)
2025-03-27 13:20:22,826 - af_claseq.slurm_utils - INFO - Processing folder: run/04_recompile/2qke_tmscore/control_prediction/bin_26 (control_prediction)
2025-03-27 13:20:22,827 - af_claseq.slurm_utils - INFO - Submitting job for run/04_recompile/2qke_tmscore/prediction/bin_26 (prediction) (Job ID: pred_bin26)
2025-03-27 13:20:22,827 - af_claseq.slurm_utils - INFO - Submitting job for run/04_recompile/2qke_tmscore/prediction/bin_23 (prediction) (Job ID: pred_bin23)
2025-03-27 13:20:22,831 - af_claseq.slurm_utils - INFO - Submitting job for run/04_recompile/2qke_tmscore/control_prediction/bin_23 (control_prediction) (Job ID: ctrl_pred_bin23)
2025-03-27 13:20:22,832 - af_claseq.slurm_utils - INFO - Submitting job for run/04_recompile/2qke_tmscore/control_prediction/bin_26 (control_prediction) (Job ID: ctrl_pred_bin26)
2025-03-27 13:20:22,913 - af_claseq.slurm_utils - INFO - Submitted job 501028 for task directory run/04_recompile/2qke_tmscore/control_prediction/bin_26
2025-03-27 13:20:22,913 - af_claseq.slurm_utils - INFO - Waiting for job 501028 to complete
2025-03-27 13:20:22,916 - af_claseq.slurm_utils - INFO - Submitted job 501029 for task directory run/04_recompile/2qke_tmscore/control_prediction/bin_23
2025-03-27 13:20:22,916 - af_claseq.slurm_utils - INFO - Waiting for job 501029 to complete
2025-03-27 13:20:22,919 - af_claseq.slurm_utils - INFO - Submitted job 501030 for task directory run/04_recompile/2qke_tmscore/prediction/bin_26
2025-03-27 13:20:22,919 - af_claseq.slurm_utils - INFO - Waiting for job 501030 to complete
2025-03-27 13:20:22,921 - af_claseq.slurm_utils - INFO - Submitted job 501031 for task directory run/04_recompile/2qke_tmscore/prediction/bin_23
2025-03-27 13:20:22,921 - af_claseq.slurm_utils - INFO - Waiting for job 501031 to complete
2025-03-27 13:21:40,788 - af_claseq - INFO - Pipeline initialized with config from configs/config_run.yaml
2025-03-27 13:21:40,810 - af_claseq - INFO - === AF-ClaSeq PIPELINE STARTED ===
2025-03-27 13:21:40,810 - af_claseq - INFO - Configuration loaded from YAML file
2025-03-27 13:21:40,810 - af_claseq - INFO - === STAGE 02_ANALYSIS: M-FOLD SAMPLING ANALYSIS ===
2025-03-27 13:21:40,810 - af_claseq - INFO - Analyzing data from 1 rounds of M-fold sampling
2025-03-27 13:21:40,811 - af_claseq - INFO - Including round 1 in analysis
2025-03-27 13:21:40,811 - af_claseq - INFO - Two filter criteria detected - generating 1D plots for each criterion and 2D plots
2025-03-27 13:21:40,811 - af_claseq - INFO - Generating 1D plot for 2qke_tmscore
2025-03-27 13:21:40,811 - af_claseq - INFO - Loading existing results from run/02_m_fold_sampling/csv/2qke_tmscore_values.csv
2025-03-27 13:21:40,876 - af_claseq - INFO - Generating 1D distribution plot for 2qke_tmscore
2025-03-27 13:21:41,783 - af_claseq - INFO - Saved 1D distribution plot to: run/02_m_fold_sampling/plot/2qke_tmscore_1d_distribution.png
2025-03-27 13:21:41,783 - af_claseq - INFO - Mean 2qke_tmscore: 0.69
2025-03-27 13:21:41,784 - af_claseq - INFO - Median 2qke_tmscore: 0.69
2025-03-27 13:21:41,784 - af_claseq - INFO - Generating 1D plot for 5jyt_tmscore
2025-03-27 13:21:41,784 - af_claseq - INFO - Loading existing results from run/02_m_fold_sampling/csv/5jyt_tmscore_values.csv
2025-03-27 13:21:41,799 - af_claseq - INFO - Generating 1D distribution plot for 5jyt_tmscore
2025-03-27 13:21:42,711 - af_claseq - INFO - Saved 1D distribution plot to: run/02_m_fold_sampling/plot/5jyt_tmscore_1d_distribution.png
2025-03-27 13:21:42,712 - af_claseq - INFO - Mean 5jyt_tmscore: 0.61
2025-03-27 13:21:42,712 - af_claseq - INFO - Median 5jyt_tmscore: 0.56
2025-03-27 13:21:42,712 - af_claseq - INFO - Generating 2D plot for combined criteria: 2qke_tmscore vs 5jyt_tmscore
2025-03-27 13:21:42,713 - af_claseq - INFO - Loading existing results from run/02_m_fold_sampling/csv/2qke_tmscore_5jyt_tmscore_values.csv
2025-03-27 13:21:43,453 - af_claseq - INFO - Saved 2D scatter plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_scatter_plddt.png
2025-03-27 13:21:44,202 - af_claseq - INFO - Saved 2D scatter plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_scatter_local_plddt.png
2025-03-27 13:21:45,789 - af_claseq - INFO - Saved joint plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_joint_plddt.png
2025-03-27 13:21:47,351 - af_claseq - INFO - Saved joint plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_joint_local_plddt.png
2025-03-27 13:21:47,352 - af_claseq - INFO - Completed M-fold sampling analysis and plotting successfully
2025-03-27 13:21:47,352 - af_claseq - INFO - === AF-ClaSEQ PIPELINE COMPLETED SUCCESSFULLY ===
2025-03-27 13:21:47,352 - af_claseq - INFO - All requested stages executed without errors
2025-03-27 13:21:47,352 - af_claseq - INFO - Results are ready for analysis in the output directories
2025-03-27 13:22:34,784 - af_claseq - INFO - Pipeline initialized with config from configs/config_run.yaml
2025-03-27 13:22:34,800 - af_claseq - INFO - === AF-ClaSeq PIPELINE STARTED ===
2025-03-27 13:22:34,800 - af_claseq - INFO - Configuration loaded from YAML file
2025-03-27 13:22:34,800 - af_claseq - INFO - === STAGE 02_ANALYSIS: M-FOLD SAMPLING ANALYSIS ===
2025-03-27 13:22:34,801 - af_claseq - INFO - Analyzing data from 1 rounds of M-fold sampling
2025-03-27 13:22:34,801 - af_claseq - INFO - Including round 1 in analysis
2025-03-27 13:22:34,801 - af_claseq - INFO - Two filter criteria detected - generating 1D plots for each criterion and 2D plots
2025-03-27 13:22:34,801 - af_claseq - INFO - Generating 1D plot for 2qke_tmscore
2025-03-27 13:22:34,802 - af_claseq - INFO - Loading existing results from run/02_m_fold_sampling/csv/2qke_tmscore_values.csv
2025-03-27 13:22:34,808 - af_claseq - INFO - Generating 1D distribution plot for 2qke_tmscore
2025-03-27 13:22:35,557 - af_claseq - INFO - Saved 1D distribution plot to: run/02_m_fold_sampling/plot/2qke_tmscore_1d_distribution.png
2025-03-27 13:22:35,558 - af_claseq - INFO - Mean 2qke_tmscore: 0.69
2025-03-27 13:22:35,558 - af_claseq - INFO - Median 2qke_tmscore: 0.69
2025-03-27 13:22:35,559 - af_claseq - INFO - Generating 1D plot for 5jyt_tmscore
2025-03-27 13:22:35,559 - af_claseq - INFO - Loading existing results from run/02_m_fold_sampling/csv/5jyt_tmscore_values.csv
2025-03-27 13:22:35,562 - af_claseq - INFO - Generating 1D distribution plot for 5jyt_tmscore
2025-03-27 13:22:36,269 - af_claseq - INFO - Saved 1D distribution plot to: run/02_m_fold_sampling/plot/5jyt_tmscore_1d_distribution.png
2025-03-27 13:22:36,270 - af_claseq - INFO - Mean 5jyt_tmscore: 0.61
2025-03-27 13:22:36,270 - af_claseq - INFO - Median 5jyt_tmscore: 0.56
2025-03-27 13:22:36,270 - af_claseq - INFO - Generating 2D plot for combined criteria: 2qke_tmscore vs 5jyt_tmscore
2025-03-27 13:22:36,270 - af_claseq - INFO - Loading existing results from run/02_m_fold_sampling/csv/2qke_tmscore_5jyt_tmscore_values.csv
2025-03-27 13:22:37,062 - af_claseq - INFO - Saved 2D scatter plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_scatter_plddt.png
2025-03-27 13:22:37,810 - af_claseq - INFO - Saved 2D scatter plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_scatter_local_plddt.png
2025-03-27 13:22:39,363 - af_claseq - INFO - Saved joint plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_joint_plddt.png
2025-03-27 13:22:40,921 - af_claseq - INFO - Saved joint plot to: run/02_m_fold_sampling/plot/2qke_tmscore_5jyt_tmscore_joint_local_plddt.png
2025-03-27 13:22:40,922 - af_claseq - INFO - Completed M-fold sampling analysis and plotting successfully
2025-03-27 13:22:40,922 - af_claseq - INFO - === AF-ClaSEQ PIPELINE COMPLETED SUCCESSFULLY ===
2025-03-27 13:22:40,922 - af_claseq - INFO - All requested stages executed without errors
2025-03-27 13:22:40,922 - af_claseq - INFO - Results are ready for analysis in the output directories
